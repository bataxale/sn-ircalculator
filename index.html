<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculateur IR — 2022+</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* ================== Design moderne & mobile-first ================== */
    :root{
      --bg:#ffffff;
      --surface:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e5e7eb;
      --ring:0 0 0 4px rgba(14,165,233,.20);
      --accent:#0ea5e9;         /* Cyan/blue */
      --accent-2:#0284c7;
      --ok:#16a34a;             /* Green */
      --danger:#ef4444;         /* Red */
      --radius:16px;
      --shadow:0 10px 30px rgba(2,6,23,.06);
      --shadow-sm:0 6px 20px rgba(2,6,23,.05);
      --grad: linear-gradient(135deg, #0ea5e9, #22c55e);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Roboto,Arial,Helvetica,sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 600px at -10% -10%, rgba(14,165,233,.08), transparent 60%),
        radial-gradient(900px 600px at 120% 0%, rgba(34,197,94,.06), transparent 60%),
        var(--bg);
      line-height:1.45;
    }

    /* Header moderne */
    header{
      padding:28px 16px 10px;
      text-align:center;
    }
    .title{
      margin:0;
      font-size:clamp(1.25rem, 4.8vw, 2.2rem);
      font-weight:800;
      letter-spacing:.2px;
      background:var(--grad);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .subtitle{
      color:var(--muted);
      font-size:.96rem;
      margin-top:6px;
    }

    /* Container */
    .wrap{
      max-width:920px;
      margin:20px auto 80px;
      padding:0 16px;
      display:grid;
      gap:16px;
    }

    /* Cards */
    .card{
      background:var(--surface);
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:var(--shadow);
    }
    .card h2{
      margin:0 0 10px;
      font-size:1.05rem;
      font-weight:800;
      letter-spacing:.2px;
    }

    /* Grid responsive */
    .grid{display:grid; gap:12px}
    @media (min-width:640px){
      .grid.cols-2{grid-template-columns:1fr 1fr}
    }

    /* Inputs */
    label{
      display:block;
      font-size:.92rem;
      color:var(--muted);
      margin:2px 0 6px;
    }
    input[type="number"]{
      width:100%;
      padding:12px 14px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
      color:var(--text);
      outline:none;
      transition:border-color .15s ease, box-shadow .15s ease, transform .02s;
      box-shadow:var(--shadow-sm);
    }
    input[type="number"]:focus{
      border-color:var(--accent);
      box-shadow:var(--ring), var(--shadow-sm);
    }

    /* Buttons */
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:12px 16px;
      border-radius:12px; border:1px solid transparent;
      cursor:pointer; font-weight:700;
      background:var(--grad); color:#ffffff;
      transition:filter .15s, transform .04s;
    }
    .btn:hover{ filter:brightness(1.05) }
    .btn:active{ transform:translateY(1px) }
    .btn.secondary{
      background:#ffffff; color:var(--text);
      border-color:var(--border);
    }
    .btn.secondary:hover{ filter:none; border-color:#cbd5e1 }
    .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px}

    /* Results */
    .hint{ color:var(--muted); font-size:.9rem }
    .result{
      margin-top:12px;
      padding:14px 16px;
      border-radius:12px;
      background:#f0f9ff;
      border:1px solid #bae6fd;
      font-weight:700;
      color:#075985;
      word-break:break-word;
    }

    /* Collapsible section at bottom */
    .collapsible{
      margin-top:4px;
      border-radius:var(--radius);
      overflow:hidden;
      border:1px solid var(--border);
      background:#ffffff;
      box-shadow:var(--shadow);
    }
    details{
      border-top:1px solid var(--border);
      padding:0;
    }
    details:first-of-type{ border-top:none }
    summary{
      padding:14px 16px;
      cursor:pointer;
      list-style:none;
      font-weight:700;
      color:#0f172a;
      display:flex; align-items:center; justify-content:space-between;
      background:linear-gradient(180deg, #fff, #fafafa);
    }
    summary::-webkit-details-marker{ display:none }
    details[open] summary{ background:#f8fafc }
    .pill{
      padding:4px 10px; border-radius:999px;
      background:#e0f2fe; color:#0369a1; font-size:.78rem; font-weight:700;
      border:1px solid #bae6fd;
    }
    .content{ padding:14px 16px }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
      font-size:.95rem;
      border:1px solid var(--border);
      border-radius:12px;
      overflow:hidden;
      background:#fff;
    }
    th, td{ padding:10px 12px; border-bottom:1px solid #eef2f7 }
    th{ text-align:left; color:#0f172a; background:#f8fafc; font-weight:700 }
    tbody tr:hover{ background:#f9fafb }
  </style>
</head>
<body>
  <header>
    <h1 class="title">Calculateur d’Impôt sur le Revenu</h1>
    <p class="subtitle">Régime <strong>2022+</strong> — Montants <em>pour la période</em> définie par “Mois de présence”. Pour un calcul <strong>mensuel</strong>, mettre <strong>1</strong> en “Mois de présence”.</p>
  </header>

  <main class="wrap">
    <!-- Carte Paramètres -->
    <section class="card" aria-labelledby="titre-params">
      <h2 id="titre-params">Paramètres</h2>
      <div class="grid cols-2">
        <div>
          <label for="parts">Nombre de parts</label>
          <input id="parts" type="number" min="1" step="0.5" value="1.5" inputmode="decimal" />
        </div>
        <div>
          <label for="months">Mois de présence (1–12)</label>
          <input id="months" type="number" min="1" max="12" step="1" value="12" inputmode="numeric" />
        </div>
      </div>
      <p class="hint" style="margin-top:8px">
        Les entrées et résultats s’appliquent à la période indiquée. (Ex. 12 = annuel, 1 = mensuel)
      </p>
    </section>

    <!-- Carte Calcul Impôt -->
    <section class="card" aria-labelledby="titre-calcul">
      <h2 id="titre-calcul">Calcul de l’impôt (période)</h2>
      <div class="grid cols-2">
        <div>
          <label for="brut">Brut imposable (pour la période)</label>
          <input id="brut" type="number" min="0" step="1000" value="1500000" inputmode="numeric" />
        </div>
        <div style="display:flex; align-items:flex-end; gap:10px">
          <button class="btn" id="calcIR" title="Calculer l’impôt">Calculer l’Impôt</button>
        </div>
      </div>

      <div id="resIR" class="result" aria-live="polite"></div>

      <p class="hint">Méthode : abattement → barème progressif → réduction (parts) → plafond (43 %) → prorata de la période.</p>

      <div class="actions">
        <button class="btn secondary" id="reset">Réinitialiser</button>
        <button class="btn secondary" id="example">Exemple</button>
      </div>
    </section>

    <!-- Collapsible en bas de page -->
    <section class="collapsible" aria-label="Références barème et taux">
      <details close>
        <summary>Barème progressif & paramètres <span class="pill">2022+</span></summary>
        <div class="content">
          <table aria-label="Barème progressif 2022+">
            <thead><tr><th>Tranche</th><th>Montant min</th><th>Montant max</th><th>Taux</th></tr></thead>
            <tbody>
              <tr><td>1</td><td>0</td><td>630 000</td><td>0 %</td></tr>
              <tr><td>2</td><td>630 001</td><td>1 500 000</td><td>20 %</td></tr>
              <tr><td>3</td><td>1 500 001</td><td>4 000 000</td><td>30 %</td></tr>
              <tr><td>4</td><td>4 000 001</td><td>8 000 000</td><td>35 %</td></tr>
              <tr><td>5</td><td>8 000 001</td><td>13 500 000</td><td>37 %</td></tr>
              <tr><td>6</td><td>13 500 001</td><td>50 000 000</td><td>40 %</td></tr>
              <tr><td>7</td><td>50 000 001</td><td>∞</td><td>43 %</td></tr>
            </tbody>
          </table>

          <table aria-label="Paramètres d’abattement & plafonds">
            <thead><tr><th>Paramètre</th><th>Valeur</th></tr></thead>
            <tbody>
              <tr><td>Abattement (plafond)</td><td>900 000</td></tr>
              <tr><td>Abattement (taux)</td><td>30 % du brut annuel théorique</td></tr>
              <tr><td>Plafond de taux d’imposition</td><td>43 % du brut annuel théorique</td></tr>
            </tbody>
          </table>

          <table aria-label="Réduction d’impôt selon nombre de parts">
            <thead><tr><th>Nombre de parts</th><th>Réduction min</th><th>Réduction max</th><th>Taux appliqué</th></tr></thead>
            <tbody>
              <tr><td>1,0</td><td>0</td><td>0</td><td>0 %</td></tr>
              <tr><td>1,5</td><td>100 000</td><td>300 000</td><td>10 %</td></tr>
              <tr><td>2,0</td><td>200 000</td><td>650 000</td><td>15 %</td></tr>
              <tr><td>2,5</td><td>300 000</td><td>1 100 000</td><td>20 %</td></tr>
              <tr><td>3,0</td><td>400 000</td><td>1 650 000</td><td>25 %</td></tr>
              <tr><td>3,5</td><td>500 000</td><td>2 030 000</td><td>30 %</td></tr>
              <tr><td>4,0</td><td>600 000</td><td>2 490 000</td><td>35 %</td></tr>
              <tr><td>4,5</td><td>700 000</td><td>2 755 000</td><td>40 %</td></tr>
              <tr><td>5,0</td><td>800 000</td><td>3 180 000</td><td>45 %</td></tr>
            </tbody>
          </table>
        </div>
      </details>
    </section>
  </main>

  <script src="ir.js"></script>
</body>
</html>

